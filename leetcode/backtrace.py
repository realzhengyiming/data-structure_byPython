# -*- coding: utf-8 -*-#
# -------------------------------------------------------------------------------
# Name:         backtrace
# Description:
# Author:       zhengyiming
# Date:         2020/10/10
# -------------------------------------------------------------------------------

# from labuladong
# å›æº¯ç®—æ³•çš„æ¡†æ¶
# ğŸ›©å…¶å®å¯ä»¥çœ‹å‡ºæ¥ï¼ŒåŒæ—¶è¿™ä¸ªä¹Ÿæ˜¯DSFï¼Œå°±æ˜¯æ·±åº¦ä¼˜å…ˆç®—æ³•ã€‚ä¸åœçš„å»è¯•è·¯ã€‚é‡åˆ°èµ°ä¸é€šæ‰æŠ˜å›å»ï¼Œè¿™å°±æ˜¯æ’åˆ°å—å¢™æ‰åœä¸‹æ¥ã€‚

# result = []
# def backtrack(è·¯å¾„, é€‰æ‹©åˆ—è¡¨):
#     if æ»¡â¾œç»“æŸæ¡ä»¶: result.add(è·¯å¾„) ï¼ˆ1ï¼‰ç»“æŸæ¡ä»¶
#         return
#     for é€‰æ‹© in é€‰æ‹©åˆ—è¡¨: ï¼ˆ2ï¼‰åšé€‰æ‹©
#         if ä¸èƒ½èµ°ï¼š
#             continue  # æ’é™¤æ‰ä¸åˆæ³•çš„ï¼›1ã€‚ä¸èƒ½èµ°ï¼›2ã€‚èµ°è¿‡äº†
#         backtrack(è·¯å¾„, é€‰æ‹©åˆ—è¡¨) ï¼ˆ3ï¼‰ é€’å½’ã€Šæ­¤å¤„å¯ä»¥åœ¨å‚æ•°ä¸Šåšè¿ç®—ï¼Œå¢åŠ æˆ–è€…å‡å°‘ï¼Œç±»ä¼¼å°¾é€’å½’ï¼‰
#         æ’¤é”€é€‰æ‹©  ï¼ˆ4ï¼‰æ’¤é”€é€‰æ‹©ï¼ˆå›æº¯ï¼‰

# def backtrack(...):
#     for é€‰æ‹© in é€‰æ‹©åˆ—è¡¨:
#         åšé€‰æ‹©
#         backtrack(...)
#         æ’¤é”€é€‰æ‹©


# forå¾ªç¯å†…çš„é€’å½’ï¼Œé€’å½’ä¹‹å‰åšé€‰æ‹©ï¼Œé€’å½’ä¹‹å æ’¤é”€é€‰æ‹©ã€‚
# ä¸é‡å¤çš„ä¸œè¥¿,æ ‘çš„èŠ‚ç‚¹ï¼Œåˆæ˜¯å’ŒäºŒå‰æ ‘ç›¸å…³ï¼Œåªè¦æ¶‰åŠåˆ° é€’å½’ï¼Œ
import copy

track = []  # é»˜è®¤è®¾ç½®ä¸º,å¯é€‰æ‹©åˆ—è¡¨ 1ï¼Œ2ï¼Œ3 é»˜è®¤
res = []  # å·²åšçš„é€‰æ‹©åˆ—è¡¨  ,æ˜¾ç¤ºè¿˜æ˜¯éšå¼çš„è¿›è¡Œç›¸å…³çš„æ“ä½œéƒ½æ˜¯å¯ä»¥çš„
nums = 3
result = []


# 1.å…¨æ’åˆ—çš„è§£å†³
def template(input):
    result = []  # è¿™é‡Œç”¨åˆ—è¡¨æ¥å¤„ç†è¿™ä¸ªä¸œè¥¿

    # å‡½æ•°çš„å‡½æ•°
    def trace(path, choices):
        # ç»“æŸæ¡ä»¶
        if len(path) == len(input):
            result.append([path.copy()])  # ä¸€æ¡è·¯å¾„å›æº¯åˆ°åº•æ‰æ·»åŠ è¿›æ¥ï¼Œè¿™æ ·åˆæ¶‰åŠåˆ°æ·±æ‹·è´æµ…æ‹·è´äº†ã€‚è¿™ç§æƒ…å†µå¦‚æœä½¿ç”¨[]é‚£å°±æ˜¯æµ…æ‹·è´ï¼Œåé¢çš„popä¼šæ¸…ç©ºï¼›liståˆ™è¿”å›ä¸€ä¸ªæ–°çš„
            # result.append(list(path))  # ä¸€æ¡è·¯å¾„å›æº¯åˆ°åº•æ‰æ·»åŠ è¿›æ¥ï¼Œè¿™æ ·åˆæ¶‰åŠåˆ°æ·±æ‹·è´æµ…æ‹·è´äº†ã€‚è¿™ç§æƒ…å†µå¦‚æœä½¿ç”¨[]é‚£å°±æ˜¯æµ…æ‹·è´ï¼Œåé¢çš„popä¼šæ¸…ç©ºï¼›liståˆ™è¿”å›ä¸€ä¸ªæ–°çš„
            return

            # åšé€‰æ‹©
        for item in choices:
            if item in path:  # æ’é™¤ä¸åˆæ³•çš„ï¼Œåšé€‰æ‹©
                continue
            path.append(item)  # å‰é¢æ²¡é€‰è¿‡è¿™ä¸ªçš„è¯é‚£å°±æ·»åŠ è¿›æ¥
            trace(path, choices)  # è·¯å¾„è¿­ä»£
            path.pop()  # æ’¤é”€é€‰æ‹©çš„æ“ä½œï¼ˆå›æº¯ï¼‰æ ¸å¿ƒåè¯åœ¨è¿™é‡Œ

    trace([], input)  # è¿è¡Œå‡½æ•°ï¼Œé»˜è®¤çš„pathæ˜¯ç©ºçš„ï¼Œæ²¡åšä»»ä½•é€‰æ‹©
    return result


# 2.N çš‡å
res = []


def N_queen(n):
    def check(board, row, col):
        '''
        æ˜¯å¦å¯ä»¥åœ¨board rowï¼ˆindexï¼‰ï¼Œcolä¸Šæ”¾ç½®çš‡åï¼›å› ä¸ºè¿™å„¿çš„boardæ˜¯list
        :param board: æ˜¯ä¸€ä¸ªlist ï¼Œé‡Œé¢çš„index ä»£è¡¨rowï¼Œ valueä»£è¡¨ colï¼›å…¶å®ç®—æ˜¯äºŒç»´æ•°æ®äº†
        :param row:  è¡Œ
        :param col:  åˆ—
        :return: True/False
        '''

        # print(board)
        # print(row)
        # print(col)
        # print()
        for i_row in range(row):  #
            åˆ—é‡åˆ = abs(board[i_row] - col)  # å‘ç”Ÿé‡åˆå°±ä¸è¡Œ
            å·¦æ–œçº¿æˆ–è€…å³æ–œçº¿çš„è·ç¦» = abs(i_row - row)
            if abs(board[i_row] - col) == 0:  # åˆ—ä¸èƒ½é‡å¤
                return False
            if abs(board[i_row] - col) == abs(i_row - row):  # ç›¸ç­‰æ—¶å€™è·ç¦»ä¸ºæ–œçº¿è·ç¦»å†…
                return False
        return True

    def eightqueen(board, row):  # 8çš‡åï¼Œå½“ç„¶è¿™å„¿å¯ä¸ä¸€å®šè¦8çš‡å
        '''
        :param board: è¿™ä¸ªæ˜¯è®¾ç½®çš„æ£‹ç›˜çš„é•¿å®½n*n
        :param row: å½“å‰æ”¾ç½®ç¬¬å‡ è¡Œçš„çš‡å
        :return:
        '''
        border = len(board)
        if row >= border:  # 1.ç»“æŸæ¡ä»¶
            # print(row)
            # print(temp)
            res.append(copy.deepcopy(board))  # è¦åšä¸€ä¸ªæ·±æ‹·è´,ä¸ç„¶å°±åªä¿ç•™äº†æœ€åä¸€ä¸‹çš„ç»“æœäº†
            for i, col in enumerate(board):  # è¿™ä¸ªæ–¹æ³•æ˜¯è¿”å›ä¸‹æ ‡+colåˆ—
                print('â–¡ ' * col + 'â–  ' + 'â–¡ ' * (len(board) - 1 - col))  # è¿™ç§æ˜¯
            print("")
        # 2.éå†é€‰æ‹©ï¼Œåšé€‰æ‹©
        for col in range(border):  # è¿™å„¿æ˜¯æŒ‰åˆ—æ¥éå†ï¼Œæ¯æ¬¡é€’å½’è¿›æ¥åˆ—éƒ½æ˜¯0ï¼Œå¼€å§‹
            if check(board, row, col):  # 3.åˆ¤æ–­æ˜¯æœ‰æœ‰æ•ˆï¼Œæ— æ•ˆå°±å–æ¶ˆè¿™ä¸ªé€‰æ‹©ã€‚é‡æ–°åšé€‰æ‹©ï¼Œé‚£è¿™ä¸ªå°±å«å›æº¯
                board[row] = col
                eightqueen(board, row + 1)  # 4.é€’å½’
                # è¿™å„¿æ²¡æœ‰æ˜¾ç¤ºå›æº¯ï¼Œå…¶å®æ˜¯æœ‰å›æº¯çš„ï¼Œåªæ˜¯å› ä¸ºè¿™å„¿çš„boardç›´æ¥æ˜¯ç”¨index å½“æˆrowï¼Œvalueå½“æˆcolï¼Œæ‰€ä»¥ä¸ç”¨å†ä½¿ç”¨"*"å¡«å……äº†
                # è¿™å„¿æ˜¯ä¸€çº¬æ•°ç»„ï¼Œç”¨äºŒç»´æ•°ç»„çš„board[row][col]åº”è¯¥æ›´å¥½çš„ç†è§£ï¼Œé‚£æ ·å°±å¯ä»¥é»˜è®¤å…ˆå¡«å……"*"ï¼Œç„¶åå†å¡«å……"Q"

    board = [0 for i in range(n)]  # næ¡è¾¹çš„æƒ…å†µ
    eightqueen(board, 0)  # é»˜è®¤ä»0è¡Œå¼€å§‹ï¼Œä¸çŸ¥é“æ€ä¹ˆçœ‹å°±ä¸€æ­¥ä¸€æ­¥æ¥è¿è¡Œã€‚ã€Šå˜é‡è¦çŸ¥é“ä»£è¡¨ä»€ä¹ˆï¼Œç„¶åå°±å¯ä»¥æ“ä½œäº†ã€‹
    print("res æ˜¯ä»€ä¹ˆ")
    print(res)


def N_queen2(n):
    # åˆ›å»ºä¸€ä¸ªäºŒç»´æ•°ç»„board =
    board = [["*" for col in range(n)] for row in range(n)]
    # print(board)
    res = []

    def put_queen(board, row):  # ä»row 0 å¼€å§‹éå†
        # 1.åœæ­¢æ¡ä»¶
        if row >= len(board):
            res.append(copy.deepcopy(board))  # æŠŠè¿™ä¸ªç»“æœæ”¾è¿›å»  ï¼Œæœç„¶æ˜¯pythonç¥æ‹·è´ï¼Œæµ…æ‹·è´çš„é—®é¢˜
            # return è¿™å„¿ä¸è¿”å›ï¼Œæ˜¯å› ä¸ºä¸æ˜¯è¿­ä»£çš„è¿”å›ï¼Œå›æ»šä¸é€šè¿‡è¿™æ ·çš„æ“ä½œï¼Œç»“æœè¿˜å¯èƒ½å¾ˆå¤šå‘¢
        for col in range(len(board)):  # æ¯ä¸€è¡Œçš„æ¯ä¸€åˆ—æ¥è¿›è¡Œå¼€å§‹æ“ä½œ
            if not check_position(board, row, col):  # æ’é™¤ä¸åˆæ³•çš„é€‰æ‹©
                continue  # ç»§ç»­å¾ªç¯
            # 2.åšé€‰æ‹©
            board[row][col] = "Q"  # æ”¾ç½®çš‡å
            # 3.è¿›å…¥ä¸‹ä¸€æ­¥å†³ç­–
            put_queen(board, row + 1)
            # 4. æ’¤é”€é€‰æ‹©
            board[row][col] = "*"
            # å› ä¸ºè¿™å„¿æœ‰ä¸€ä¸ªæ’¤é”€çš„æ“ä½œï¼Œæ‰€ä»¥å¿…é¡»è¦æ·±æ‹·è´ï¼Œ
            # ä¹Ÿå¯ä»¥ä¸è¦è¿™ä¸ªçš„ã€‚ä¸è¿‡ä¸ºäº†ä¿æŒé‚£ä¸ªç»“æ„å¥½ç†è§£
            # è¿˜æ˜¯å¸¦ä¸Šå¥½

    def check_position(board, row, col):  # æ£€æŸ¥è¿™ä¸ªä½ç½®å¯ä¸å¯ä»¥å†æ”¾ç½®çš‡åï¼›ç«–ç›´ä¸‹æ¥ï¼Œè¿˜æœ‰æ–œç€çš„,è¿™å„¿ä¸æ˜¯
        for row_ in range(len(board[:row + 1])):
            for col_ in range(len(board)):
                if board[row_][col_] == "Q":  # åˆ—æ”¾ç½®åˆ—Qé‚£å°±ä¸è¡Œ
                    if col - col_ == 0:
                        return False
                    if abs(col - col_) == abs(row - row_):
                        return False  # æ²¡ç»å¯¹å€¼çš„å°±åˆ†æˆä¸¤ä¸ªå¼å­
        return True

    put_queen(board, row=0)
    for u in res:
        print(u)
        print()
    # return res

# todo éšæœºç”Ÿæˆä¸€ä¸ªè¿·å®«ï¼Œç„¶åå†ä½¿ç”¨å›æº¯ç®—æ³•ï¼Œæ¢ç´¢å‡ºè¿·å®«çš„è·¯ï¼Œç”Ÿæˆè·¯
# todo æ°´æ»¡å¯»è·¯ç®—æ³•ï¼Œå«ä»€ä¹ˆç»™å¿˜è®°äº†ï¼Œå¯ä»¥å¤šçº¿ç¨‹ï¼Œå¤šæ–¹å‘è¿›è¡Œå¯»è·¯çš„å§ã€‚

if __name__ == '__main__':
    # nums = 3
    # backtrack(3)

    # è¿™ä¸ªæ˜¯å…¨æ’åˆ—çš„
    # result = template([1, 2, 3])
    # print(result)

    # è¿™ä¸ªæ˜¯nçš‡å
    # N_queen(4)

    # è¿™ä¸ªæ˜¯Nçš‡åï¼Œä½¿ç”¨äºŒç»´æ•°ç»„çš„ï¼Œæ›´åŠ æ¸…æ™°ä¸€ç‚¹
    N_queen2(4)
